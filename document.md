# ğŸ” Secure Command Gateway for Industrial Robot Protection  ### A Cryptography-Based Framework to Prevent Unauthorized Remote Control CommandsThis project implements a **software-only security layer** that protects industrial robots from unauthorized remote command execution.  It uses strong cryptographic techniques to validate every command sent by an operator before forwarding it to a robot.---# ğŸš€ Features- RSA Digital Signature Verification  - Timestamp Freshness Validation  - Nonce-Based Replay Protection  - Role-Based Access Control (RBAC)  - Secure Command Forwarding to Robot  - Complete Simulation of Attack Scenarios  - Fully Functional on Windows (PowerShell)---# ğŸ“ Project Structurerobot-security/â”‚â”œâ”€â”€ scg.pyâ”œâ”€â”€ client.pyâ”œâ”€â”€ mock_robot.pyâ”œâ”€â”€ client_pub.pemâ”œâ”€â”€ audit.logâ”‚â””â”€â”€ ca/â”œâ”€â”€ private/â”‚ â”œâ”€â”€ ca.keyâ”‚ â”œâ”€â”€ scg.keyâ”‚ â””â”€â”€ client.keyâ”œâ”€â”€ csr/â””â”€â”€ certs/â”œâ”€â”€ ca.crtâ”œâ”€â”€ scg.crtâ””â”€â”€ client.crtyamlCopy code---# ğŸ–¥ 1. Installation (Windows)Install required tools:### Install Python packages```bashpip install fastapi uvicorn cryptography requestsInstall OpenSSLDownload from:https://slproweb.com/products/Win32OpenSSL.htmlInstall Win64 OpenSSL v3.x Full and check:Add OpenSSL to system PATHğŸ”‘ 2. Certificate Authority (CA) SetupNavigate to CA folder:powershellCopy codecd D:\robot-security\ca2.1 Generate Root CApowershellCopy codeopenssl genrsa -out private\ca.key 4096powershellCopy codeopenssl req -x509 -new -nodes -key private\ca.key -sha256 -days 3650 -subj "/CN=Local-CA" -out certs\ca.crt2.2 Generate SCG CertificatespowershellCopy codeopenssl genrsa -out private\scg.key 2048powershellCopy codeopenssl req -new -key private\scg.key -out csr\scg.csr -subj "/CN=SCG"powershellCopy codeopenssl x509 -req -in csr\scg.csr -CA certs\ca.crt -CAkey private\ca.key -CAcreateserial -out certs\scg.crt -days 825 -sha2562.3 Generate Client CertificatespowershellCopy codeopenssl genrsa -out private\client.key 2048powershellCopy codeopenssl req -new -key private\client.key -out csr\client.csr -subj "/CN=OperatorClient"powershellCopy codeopenssl x509 -req -in csr\client.csr -CA certs\ca.crt -CAkey private\ca.key -CAcreateserial -out certs\client.crt -days 365 -sha2562.4 Extract Client Public KeypowershellCopy codeopenssl x509 -in certs\client.crt -pubkey -noout &gt; ..\client_pub.pemâš™ï¸ 3. Running the SystemOpen three separate PowerShell terminals.3.1 Terminal 1 â€“ Mock Robot ServerpowershellCopy codecd D:\robot-securitypython mock_robot.pyExpected:nginxCopy codeUvicorn running on http://127.0.0.1:80013.2 Terminal 2 â€“ Secure Command Gateway (SCG)powershellCopy codecd D:\robot-securitypython scg.pyExpected:nginxCopy codeUvicorn running on http://127.0.0.1:80023.3 Terminal 3 â€“ ClientpowershellCopy codecd D:\robot-securitypython client.pyExpected:cssCopy codeRAW Response: {"status":"executed", ...}ğŸ§ª 4. Testing Security ScenariosBelow are reproducible test cases to validate the security framework.4.1 Scenario 1 â€” Valid Command (PASS)powershellCopy codepython client.pyExpected: Command accepted &amp; executed.4.2 Scenario 2 â€” Invalid Signature (FAIL)Modify in client.py:pythonCopy codepacket["signature"] = packet["signature"][:-4] + "ABCD"Expected:SCG rejects â†’ "Invalid Signature"4.3 Scenario 3 â€” Replay Attack (FAIL)Add:pythonCopy codelast_packet = Nonesend_command("MOVE", {...}, reuse=False)send_command("MOVE", {...}, reuse=True)Expected:SCG rejects â†’ "Replay Detected"4.4 Scenario 4 â€” Stale Timestamp (FAIL)Modify:pythonCopy code"timestamp": time.time() - 200Expected:SCG rejects â†’ "Stale Timestamp"4.5 Scenario 5 â€” Unauthorized Command (RBAC Violation) (FAIL)pythonCopy codesend_command("SHUTDOWN", {})Expected:SCG rejects â†’ "Not Authorized"4.6 Scenario 6 â€” Payload Tampering (FAIL)pythonCopy codesignature_b64, payload_bytes = sign_payload(payload)payload["command"] = "STOP"Expected:SCG rejects â†’ "Invalid Signature"ğŸ“Š 5. Test Case SummaryTest Case	Scenario	Expected Outcome	ResultTC-01	Valid Signed Command	Accept &amp; Execute	PASSTC-02	Invalid Signature	Reject	PASSTC-03	Replay Attack	Reject	PASSTC-04	Stale Timestamp	Reject	PASSTC-05	Unauthorized RBAC Command	Reject	PASSTC-06	Payload Tampering	Reject	PASSğŸ›  TroubleshootingIssue	Fixopenssl: not recognized	Add OpenSSL /bin to PATHclient_pub.pem empty	Re-run extraction commandReplay not detected	Ensure SCG runs with workers=1JSONDecodeError	SCG crashed â†’ check logsPort in use	Change ports in scg.py / mock_robot.pyğŸ“Œ SummaryThis project demonstrates how cryptographic techniques can secure industrial robots against unauthorized access. Using RSA signatures, freshness verification, replay prevention, and RBAC policies, the Secure Command Gateway ensures only legitimate operator commands reach the robot.The implementation is fully functional, reproducible, and designed for academic and research applications.